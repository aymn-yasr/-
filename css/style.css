/* General Styles (Keep as is, just for context) */
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: #f0f2f5;
  direction: rtl;
  color: #333;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  overscroll-behavior: none;
}

.top-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  cursor: pointer;
  padding: 5px 10px;
  border-radius: 10px;
  transition: background-color 0.3s ease;
}

.top-btn:hover {
  background-color: rgba(255, 255, 255, 0.1);
}

.top-btn .icon {
  font-size: 20px;
  margin-bottom: 3px;
}

.profile-avatar {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  object-fit: cover;
}

.user-profile-btn {
  position: relative;
}

.avatar-badge {
  position: absolute;
  bottom: -5px;
  right: -5px;
  background-color: #f00; /* Example: Red for new notifications */
  color: white;
  border-radius: 50%;
  width: 15px;
  height: 15px;
  font-size: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  border: 1px solid #333;
}


/* Chat Container */
.chat-container {
  display: flex;
  flex-direction: column;
  flex-grow: 1; /* Allow chat-container to take all available space */
  max-width: 900px; /* Max width for desktop */
  width: 100%;
  margin: 0 auto; /* Center the container on desktop */
  background-color: #f0f2f5;
  box-sizing: border-box;
  /* Adjust top and bottom padding/margin to account for fixed bars */
  padding-top: 60px; /* Height of top-bar */
  padding-bottom: 75px; /* Height of input-bar + its bottom margin */
  height: 100vh; /* Ensure chat-container fills viewport height for scrolling */
}

/* Chat Box (Messages Display Area) */
#chat-box { /* This is the ID of the div in chat.html that loads chat-box.html */
  flex-grow: 1; /* This ID container should also grow */
  display: flex;
  flex-direction: column;
  overflow: hidden; /* Important for flex child overflow */
}

.chat-box { /* This is the class inside chat-box.html */
  padding: 15px 10px;
  overflow-y: auto; /* Allow scrolling for chat messages */
  background: #fff;
  margin: 0 15px; /* Margin from the sides */
  border-radius: 15px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  flex-grow: 1; /* This allows the actual message container to fill space */
  display: flex;
  flex-direction: column;
   /* هذا هو التعديل الذي سيحل المشكلة */
}

/* Input Bar */
.input-bar {
  display: flex;
  align-items: center;
  padding: 10px 15px;
  background: #fff;
  border-top: 1px solid #eee;
  box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
  border-top-left-radius: 15px;
  border-top-right-radius: 15px;
  /* Make input bar fixed */
  position: fixed; /* Changed from sticky to fixed for stronger adherence */
  bottom: 0;
  width: 100%; /* Take full width */
  left: 0; /* Align to left in LTR, will be right in RTL due to body direction */
  box-sizing: border-box; /* Include padding/border in width */
  z-index: 1000;
  flex-shrink: 0; /* Prevent input-bar from shrinking */
  height: 60px; /* Fixed height for input bar */
  margin: 0 15px 15px 15px; /* Adjust margin for spacing, now that it's fixed */
}

.input-bar input {
  flex-grow: 1;
  border: none;
  padding: 10px 15px;
  border-radius: 20px;
  background: #f0f2f5;
  margin: 0 10px;
  font-size: 16px;
  outline: none;
}

.input-bar button {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: #007bff;
  padding: 5px;
  transition: color 0.3s ease;
}

.input-bar button:hover {
  color: #0056b3;
}

.input-bar .send-btn {
  font-size: 28px;
  color: #28a745;
}

.input-bar .send-btn:hover {
  color: #218838;
}

/* Message Styles */
/* --- التعديلات لـ .message-item (عنصر الرسالة بالكامل) --- */
.message-item {
    display: flex; /* يجعل الصورة الرمزية ومحتوى الرسالة (الاسم، الرتبة، النص) في سطر واحد */
    align-items: center; /* **الأهم للمحاذاة العمودية:** يجعل الصورة الرمزية، الرتبة، والاسم متوازيين في المنتصف */
    
    background-color: white; /* خلفية بيضاء لفقاعة الرسالة */
    border: 1px solid #ddd; /* حد خفيف جداً */
    
    box-shadow: none !important; /* إزالة أي ظل قد يكون موجوداً */
    color: #000; /* لون نص الرسالة */
    font-size: 14px; /* حجم خط نص الرسالة */
    line-height: 1.4; /* ارتفاع سطر نص الرسالة */

    border-bottom: 1px solid #eee; /* خط فاصل خفيف أسفل كل رسالة */
    margin-left: 0; /* **إزالة المساحة الزائدة على اليسار:** يضمن أن الرسالة تبدأ من حافة صندوق الدردشة في اتجاه RTL */
    margin-right: 0; /* إزالة أي هامش على اليمين */
    width: auto; /* يسمح للرسالة بأخذ عرضها الطبيعي ضمن الحاوية */
    border-radius: 8px; /* حواف دائرية */
    padding: 8px; /* تباعد داخلي */
    margin-bottom: 10px; /* تباعد عن الرسائل الأخرى */
    border-left: 3px solid #000; /* شريط جانبي بلون رمادي */
}

/* لا تقم بتغيير هذا الجزء إذا كنت تريده */
.message-item:last-child {
    border-bottom: none; /* لا يوجد خط فاصل للرسالة الأخيرة */
}

.user-avatar {
    width: 40px; /* عرض الصورة الرمزية */
    height: 40px; /* ارتفاع الصورة الرمزية */
    min-width: 40px; /* يمنع الصورة الرمزية من الانكماش */
    min-height: 40px; /* يمنع الصورة الرمزية من الانكماش */
    border-radius: 50%; /* لجعل الصورة دائرية */
    overflow: hidden; /* لإخفاء أي جزء زائد من الصورة إذا كانت لا تتناسب مع الشكل الدائري */
    position: relative; /* ضروري إذا كان لديك عناصر داخلها (مثل .avatar-num) */

    margin-left: 2px; /* **المسافة بين الصورة الرمزية ومحتوى الرسالة (الرتبة والاسم)** */
    margin-right: 0; /* **إزالة المساحة التي كانت تظهر بجانب الصورة الرمزية:** يضمن عدم وجود هامش على اليمين */
    flex-shrink: 0; /* يمنع الصورة الرمزية من الانكماش إذا كانت المساحة ضيقة */

    display: flex; /* لترتيب محتوى الصورة الرمزية (الصورة الفعلية والرقم) */
    justify-content: center; /* محاذاة أفقية للمحتوى داخل الصورة الرمزية */
    align-items: center; /* محاذاة عمودية للمحتوى داخل الصورة الرمزية */
    font-size: 10px; /* حجم الخط لأي نص داخل الصورة الرمزية (مثل رقم) */
    color: white; /* لون النص داخل الصورة الرمزية */
    font-weight: bold; /* وزن الخط للنص داخل الصورة الرمزية */
}

.user-avatar .profile-image {
    width: 100%; /* تجعل الصورة تأخذ العرض الكامل للأيقونة */
    height: 100%; /* تجعل الصورة تأخذ الارتفاع الكامل للأيقونة */
    object-fit: cover; /* لملء المساحة المتاحة دون تشويه الصورة */
}

.user-avatar .avatar-num {
    position: absolute; /* لتموضع الرقم فوق الصورة الرمزية */
    bottom: -2px; /* المسافة من الأسفل */
    right: -2px; /* المسافة من اليمين */
    background-color: rgba(0, 0, 0, 0.5); /* خلفية شبه شفافة للرقم */
    color: white; /* لون نص الرقم */
    border-radius: 50%; /* لجعل الرقم دائرياً */
    width: 18px; /* عرض دائرة الرقم */
    height: 18px; /* ارتفاع دائرة الرقم */
    font-size: 10px; /* حجم خط الرقم */
    display: flex; /* لترتيب محتوى الرقم (النص) */
    justify-content: center; /* محاذاة أفقية للنص داخل دائرة الرقم */
    align-items: center; /* محاذاة عمودية للنص داخل دائرة الرقم */
}

/* Gradient backgrounds for avatars */
.gradient-pink { background: linear-gradient(45deg, #ff6b6b, #ff006e); }
.gradient-purple { background: linear-gradient(45deg, #6a11cb, #2575fc); }
.gradient-green { background: linear-gradient(45deg, #13f1fc, #046bf2); }
.gradient-gold { background: linear-gradient(45deg, #ffd700, #ffa500); }


.message-info {
    flex-grow: 1; /* يسمح لـ message-info بأن يأخذ المساحة المتبقية */
    margin-right: 0; /* تأكد من عدم وجود مسافة غير مرغوبة على اليمين */
    margin-left: 0; /* تأكد من عدم وجود مسافة غير مرغوبة على اليسار */
}

.message-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 5px;
}

.message-name {
    display: flex; /* يجعل أيقونة الرتبة واسم المستخدم في سطر واحد */
    align-items: center; /* **محاذاة عمودية:** يضمن أن أيقونة الرتبة والاسم متوازيان في المنتصف */
    white-space: nowrap; /* يمنع الاسم من الالتفاف إلى سطر جديد إذا كان طويلاً */
    margin-bottom: 2px; /* مسافة صغيرة تحت الاسم/الرتبة قبل نص الرسالة */
}

/* User name colors */
.name-red { color: #e74c3c; }
.name-blue { color: #3498db; }
.name-green { color: #27ae60; }
.name-gold { color: #f39c12; }

.message-name .star-icon {
  margin-right: 5px; /* Space between name and star */
  font-size: 16px;
  color: gold;
}


.message-time {
  font-size: 0.8em;
  color: #999;
}

.message-text {
  background: #e99eb;
  padding: 0px 5px;
  border-radius: 15px;
  font-size: 16px;
  max-width: 80%; /* Limit message bubble width */
  word-wrap: break-word; /* Ensure long words break */
  display: inline-block; /* Allow padding to wrap content */
  position: relative;
  text-align: right; /* Default text alignment for RTL */
}

/* Badges for message */
.message-badge {
  display: inline-block;
  background-color: #007bff;
  color: white;
  padding: 2px 8px;
  border-radius: 10px;
  font-size: 0.7em;
  margin-right: 5px;
  vertical-align: middle;
}

/* Message status */
.message-status {
  font-size: 0.7em;
  color: #777;
  margin-top: 5px;
  text-align: left; /* Align status to the left */
}

/* ... (كود CSS الموجود مسبقاً) ... */

.dots-options {
  margin-right: 10px;
  cursor: pointer;
  font-size: 20px;
  color: #999;
  position: relative; /* مهم لتموضع القائمة المنبثقة داخله */
}
/* تنسيق القائمة المنبثقة */
.message-options-menu {
  position: absolute;
  top: 0; /* لجعلها محاذية للجزء العلوي من زر النقاط */
  left: 0; /* محاذاة يسار القائمة مع يسار زر النقاط */
  transform: translateX(-100%); /* دفع القائمة إلى اليسار بمسافة تساوي عرضها */
  /* إذا أردت مسافة إضافية بين القائمة والزر، أضف: margin-left: -5px; */
  width: 150px; /* تحديد عرض ثابت للقائمة */
  background-color: #fff;
  border: 1px solid #eee;
  border-radius: 8px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  z-index: 10;
  display: none; /* إخفاء القائمة بشكل افتراضي */
  opacity: 0;
  transition: opacity 0.2s ease-in-out, transform 0.2s ease-in-out;
  padding: 5px 0;
  text-align: right; /* محاذاة النص داخل القائمة لليمين */
  overflow: hidden; /* لمنع أي محتوى من تجاوز العرض المحدد */
}

.message-options-menu.show-options {
  display: block; /* إظهار القائمة عند إضافة الفئة */
  opacity: 1;
  transform: translateY(0);
}

.option-item {
  padding: 10px 15px;
  cursor: pointer;
  color: #333;
  font-size: 14px;
  transition: background-color 0.2s ease;
}

.option-item:hover {
  background-color: #f0f2f5;
}

/* ... (بقية كود CSS) ... */

/* System message specific styles */
.system-message {
  text-align: center;
  margin: 15px 0;
  font-style: italic;
  color: #777;
  font-size: 0.9em;
}

.system-message-content {
  background-color: #e0e0e0;
  padding: 8px 15px;
  border-radius: 10px;
  display: inline-block; /* Shrink to content */
  max-width: 70%;
  word-wrap: break-word;
}

/* Responsive Adjustments */
@media (max-width: 768px) {
  .top-bar {
    padding: 5px 0;
    height: 50px; /* Smaller height on mobile */
  }

  .top-btn {
    padding: 3px 5px;
  }

  .top-btn .icon {
    font-size: 18px;
  }

  .chat-container {
    padding-top: 60px; /* Height of top-bar on mobile */
    padding-bottom: 110px; /* Height of input-bar on mobile + its bottom margin */
    /* Height is already 100vh on chat-container */
  }

  .input-bar {
    height: 50px; /* Smaller height on mobile */
    margin: 0 15px 15px 15px; /* Adjust margin for mobile fixed position */
  }

  .chat-box {
    margin: 0 10px;
  }

  .message-item {
    margin-bottom: 10px;
  }

  .message-text {
    max-width: 90%;
  }
}

/* Desktop specific adjustments for chat container */
@media (min-width: 769px) {
  .chat-container {
    border-radius: 15px;
    box-shadow: 0 0 20px rgba(0,0,0,0.1);
    /* No height override needed here as 100vh on chat-container works */
  }

  .input-bar {
      /* Keep desktop specific input-bar styling here if needed */
      margin: 0 15px 15px 15px; /* Desktop margin for fixed input-bar */
  }
}

/* Add bottom bar styling if bottom-bar.html is used */
.bottom-bar {
    background-color: #333;
    color: white;
    padding: 10px;
    text-align: center;
    font-size: 0.8em;
    flex-shrink: 0;
    border-top-left-radius: 15px;
    border-top-right-radius: 15px;
    margin: 0 15px 15px 15px; /* Matches chat-container margin */
    box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
}

@media (max-width: 768px) {
    .bottom-bar {
        position: sticky; /* Or fixed if preferred */
        bottom: 0;
        margin: 0 15px 0 15px;
        border-radius: 0; /* No rounded corners if it's edge-to-edge */
    }
}

/* Styling for the temporary quote bubble above input field */
.active-quote-bubble {
  display: flex; /* لترتيب العناصر داخله (الاسم والنص وزر الإغلاق) */
  align-items: center;
  justify-content: space-between; /* لدفع زر الإغلاق إلى اليمين */
  background-color: #f0f0f0; /* خلفية فاتحة للفقاعة */
  border-right: 4px solid #4CAF50; /* الخط الجانبي الأخضر */
  padding: 8px 15px;
  margin: 0 15px 10px 15px; /* هامش بين الفقاعة وشريط الإدخال */
  border-radius: 8px;
  font-size: 0.9em;
  color: #333;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1); /* ظل خفيف */
  position: absolute; /* مهم: ليكون فوق شريط الإدخال */
  bottom: 75px; /* ارتفاع input-bar (60px) + margin-bottom (15px) */
  left: 0;
  right: 0;
  z-index: 999; /* ليكون فوق عناصر أخرى ولكن تحت الأشرطة الثابتة الرئيسية */
  direction: rtl; /* لضمان الاتجاه الصحيح */
  box-sizing: border-box; /* لضمان أن العرض يشمل البادينج */
}

.active-quote-bubble .quote-content-wrapper {
  flex-grow: 1; /* للسماح للمحتوى بأخذ المساحة المتاحة */
  display: flex;
  flex-direction: column;
  overflow: hidden; /* لمنع تجاوز المحتوى */
}

.active-quote-bubble .quote-sender-name {
  font-weight: bold;
  color: #075E54; /* نفس لون اسم المرسل في الاقتباس داخل الرسالة */
  margin-bottom: 2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.active-quote-bubble .quote-text-preview {
  color: #666;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.active-quote-bubble .close-quote-btn {
  background: none;
  border: none;
  font-size: 1.2em;
  color: #888;
  cursor: pointer;
  margin-right: 10px; /* مسافة بين زر الإغلاق والمحتوى */
  padding: 0;
}

/* New/Updated Styling for quoted messages within the chat bubble */
.quoted-message {
  /* Inherit styles from active-quote-bubble for consistency */
  background-color: #f0f0f0; /* Same as active-quote-bubble */
  border-right: 4px solid #4CAF50; /* Same green line */
  padding: 8px 12px; /* Slightly less padding than active-quote-bubble if needed, adjust as desired */
  margin-bottom: 5px; /* Important: Add space between quote and main message text */
  border-radius: 8px; /* Rounded corners */
  box-shadow: 0 1px 3px rgba(0,0,0,0.08); /* Lighter shadow for in-chat quote */
  font-size: 0.85em; /* Slightly smaller font size */
  color: #333;
  overflow: hidden; /* For ellipsis on content */
  direction: rtl;
}

.quoted-message .quoted-sender-name {
  font-weight: bold;
  color: #075E54; /* WhatsApp green-ish color */
  margin-bottom: 2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.quoted-message .quoted-content {
  color: #666; /* Slightly lighter text for the content */
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* هذا هو الكود الجديد الذي تم نقله من top-bar.html */

/* General Body Styles - if not already defined globally in style.css */
/* ملاحظة: تأكد من أن هذه القواعد لا تتكرر إذا كانت موجودة بالفعل في بداية style.css */
body {
  margin: 0;
  font-family: Tahoma, sans-serif;
  direction: rtl; /* هذا قد يكون موجودًا بالفعل في style.css العام */
}

/* Top Bar */
.top-bar {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0;
  background: #333; /* Darker background color */
  color: white;
  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
  position: fixed;
  top: 0;
  width: 100%;
  z-index: 1000;
  box-sizing: border-box;
  height: 60px; /* تم تقليل الارتفاع ليتناسب مع الصورة */
  overflow: hidden;
  /* أضف border-bottom-left-radius و border-bottom-right-radius إذا أردت الشريط العلوي مستديرًا من الأسفل */
  /* border-bottom-left-radius: 20px; */
  /* border-bottom-right-radius: 20px; */
}

/* Top Buttons Container */
.top-buttons {
  display: flex;
  flex-grow: 1;
  justify-content: space-around;
  align-items: stretch;
  flex-wrap: nowrap;
  height: 100%;
  width: 100%;
  margin: 0;
  padding: 0 2px;
  box-sizing: border-box;
  gap: 2px; /* حافظ على الفجوة بين الأزرار */
}

/* Button Styles - جعل كل زر مربعًا وبنفس الحجم */
.btn,
.profile {
  display: flex;
  flex-direction: column;
  justify-content: center; /* هذا كان يوسّط عموديًا */
  align-items: center;

  flex-basis: 0;
  flex-grow: 1;
  flex-shrink: 1;

  aspect-ratio: 1 / 1;
  /* min-width و max-width سيتم ضبطهما بواسطة media queries */
  height: 100%; /* اجعل الارتفاع 100% من الأب (top-buttons) */
  box-sizing: border-box;

  font-size: 0.9em;
  padding: 2px 0;
  border-radius: 8px; /* تم تقليل border-radius قليلاً ليتناسب مع الصورة */
  text-align: center;
  color: white; /* اللون الأساسي للنص أبيض */
  font-weight: bold;
  box-shadow: 0 1px 3px rgba(0,0,0,0.2);
  line-height: 1.2;
  white-space: nowrap;
  cursor: pointer;
  overflow: hidden;
  position: relative; /* ضروري للعنصر الزائف */
}

/* Button Gradient Colors - **هنا التغيير الرئيسي في الألوان والتدرجات** */
/* الألوان هي تقدير بصري من الصورة */
.menu {
  background: linear-gradient(to bottom, #72de98, #5ed692); /* أقرب للأخضر الفاتح */
}
.private {
  background: linear-gradient(to bottom, #57b1e4, #46a3db); /* أقرب للأزرق الفاتح */
}
.friend {
  background: linear-gradient(to bottom, #67b8e3, #46a7de); /* نفس لون الصديق في الصورة */
}
.notify {
  background: linear-gradient(to bottom, #ffc74a, #ffa200); /* يبدو مطابقاً لما لديك */
}
.online {
  background: linear-gradient(to bottom, #f3b14d, #e69138); /* برتقالي/ذهبي مشابه للاتصال */
}
.report {
  background: linear-gradient(to bottom, #ff5e5e, #e14040); /* يبدو مطابقاً لما لديك */
}
.refresh {
  background: linear-gradient(to bottom, #8e44ad, #9b59b6); /* يبدو مطابقاً لما لديك */
}

/* **تأثير التغطية باللون الأبيض على الكتابة والإيموجي (تم تعديله)** */
.btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(255, 255, 255, 0.1);
  mix-blend-mode: overlay; /* تغيير مهم هنا */
  pointer-events: none;
  z-index: 1;
}

/* **ضبط عناصر الأيقونات والنصوص لتظهر فوق الطبقة البيضاء وتتأثر بالمزج** */
.btn > *, .profile > * {
  position: relative;
  z-index: 2;
}

/* **تغيير جديد: تكبير حجم الإيموجيات والأيقونات داخل الأزرار وتنزيلها قليلاً** */
/* استهداف أي عنصر يعتبر أيقونة أو إيموجي داخل .btn */
.btn i, /* لاستهداف أيقونات Font Awesome مثلاً */
.btn span.emoji, /* إذا كنت تستخدم span لتغليف الإيموجي */
.btn img.icon { /* إذا كانت الأيقونات صوراً */
  font-size: 24px; /* حجم خط أكبر للإيموجي/الأيقونة النصية */
  width: 24px;   /* عرض أكبر للأيقونة الصورية */
  height: 24px;  /* ارتفاع أكبر للأيقونة الصورية */
  margin-bottom: 2px; /* مسافة بسيطة بين الأيقونة والنص */
  /* **التعديل الجديد لتنزيل الأيقونة/الإيموجي قليلاً** */
  transform: translateY(2px); /* أو أي قيمة أخرى مثل 3px, 4px حسب الحاجة */
}

/* Profile Picture Specific Styles */
.profile {
  padding: 0;
  border: 2px solid white; /* حافظ على هذا إذا أردت حدود بيضاء حول الصورة */
  background: #555; /* لون خلفية احتياطي */
  border-radius: 8px; /* تأكد من تطابق border-radius مع الأزرار الأخرى */
}

.profile img {
  width: 100%;
  height: 100%;
  border-radius: 0; /* الصورة نفسها لا تكون مستديرة الزوايا بشكل كامل، بل الحاوية */
  object-fit: cover;
}

.profile .verified {
  font-size: 10px;
  bottom: 0px;
  left: 0px;
  padding: 1px 2px;
  transform: translate(-10%, 10%);
  border-radius: 50%;
  background-color: #28a745; /* مثال على لون شارة التحقق */
  color: white;
}

/* Media Queries for smaller screens to ensure fit */
@media (max-width: 768px) {
    .top-bar {
        height: 60px; /* تم تعديله ليتناسب */
    }
    .top-buttons {
        padding: 0 1px;
        gap: 1px;
    }
    .btn, .profile {
        font-size: 0.85em; /* زيادة بسيطة في حجم الخط */
        min-width: 50px;
    }
    /* تكبير الإيموجيات/الأيقونات في الشاشات الأصغر */
    .btn i, .btn span.emoji, .btn img.icon {
        font-size: 22px;
        width: 22px;
        height: 22px;
        transform: translateY(2px); /* تطبيق التنزيل هنا أيضاً */
    }
}

@media (max-width: 500px) {
    .top-bar {
        height: 55px; /* تم تعديله ليتناسب */
    }
    .top-buttons {
        padding: 0 0px;
        gap: 0px;
    }
    .btn, .profile {
        font-size: 0.8em; /* زيادة بسيطة في حجم الخط */
        min-width: 45px;
    }
    .profile .verified {
        font-size: 9px;
    }
    /* تكبير الإيموجيات/الأيقونات في الشاشات الأصغر جداً */
    .btn i, .btn span.emoji, .btn img.icon {
        font-size: 20px;
        width: 20px;
        height: 20px;
        transform: translateY(1px); /* قد تحتاج قيمة أقل هنا */
    }
}

@media (max-width: 360px) {
    .top-bar {
        height: 50px; /* تم تعديله ليتناسب */
    }
    .btn, .profile {
        font-size: 0.75em; /* زيادة بسيطة في حجم الخط */
        min-width: 40px;
        padding: 1px 0;
    }
    .profile .verified {
        font-size: 8px;
    }
    /* تكبير الإيموجيات/الأيقونات في الشاشات الأصغر جداً جداً */
    .btn i, .btn span.emoji, .btn img.icon {
        font-size: 18px;
        width: 18px;
        height: 18px;
        transform: translateY(1px); /* قد تحتاج قيمة أقل هنا */
    }
}


/* Private Chat Modal Strip */
/* Private Chat Modal Strip */
.private-chat-modal-strip {
  position: fixed; /* يبقى المودال ثابتاً في مكانه بالنسبة للشاشة */
  /* **الموضع الجديد للمودال: يمتد من تحت زر الخاص** */
  top: 70px; /* يبدأ بعد الشريط العلوي مباشرة (ارتفاع الشريط العلوي) */
  right: 15px; /* **المسافة من اليمين (يمكنك ضبطها لتناسب موقع زر الخاص)** */
  /* تم زيادة 'right' قليلاً لإبعاده عن الحافة */
  
  background-color: #fff;
  border-radius: 10px; /* حواف مستديرة للمودال */
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); /* ظل المودال */
  z-index: 1001; /* تأكد من أنه يظهر فوق العناصر الأخرى */
  
  /* **خصائص جعل المودال كبيراً ولكن بحجم معتدل** */
  width: 90%; /* **عرض المودال، 90% من عرض النافذة** */
  max-width: 350px; /* **الحد الأقصى للعرض (تم تقليله من 400px)** */
  height: auto; /* الارتفاع يتحدد تلقائياً بناءً على المحتوى */
  max-height: calc(100vh - 100px); /* **الحد الأقصى للارتفاع (تم تقليله من 80px إلى 100px)** */
  /* هذا يترك مساحة أكبر في الأسفل و الأعلى */

  overflow-y: auto; /* لإضافة شريط تمرير عمودي إذا كان المحتوى يتجاوز الارتفاع الأقصى */
  
  display: none; /* مخفي افتراضياً، سيتم إظهاره بالـ JS */
  padding: 15px; /* هامش داخلي */
  transform-origin: top right; /* لتأثير الحركة يبدأ من الزاوية العلوية اليمنى */
  animation: fadeInFromTopRight 0.2s ease-out; /* اسم الحركة */
}

.private-chat-modal-strip.show {
  display: block; /* لإظهار المودال */
}

.private-chat-modal-strip .modal-header,
.online-users-modal .modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 15px;
    background-color: #f0f0f0; /* لون خلفية للرأس */
    border-bottom: 1px solid #eee;
    border-top-left-radius: 8px;
    border-top-right-radius: 8px;
    position: sticky; /* لجعل الرأس ثابتًا */
    top: 0; /* يلتصق بالأعلى */
    z-index: 1; /* ليكون فوق المحتوى */
}

.private-chat-modal-strip .modal-header h3,
.online-users-modal .modal-header h3 {
    margin: 0;
    font-size: 1.1em;
    color: #333;
}

/* زر الإغلاق */
.private-chat-modal-strip .close-btn,
.online-users-modal .close-btn {
    background: none;
    border: none;
    font-size: 1.5em;
    cursor: pointer;
    color: #666;
    padding: 5px;
    line-height: 1;
    transition: color 0.2s ease;
}

.private-chat-modal-strip .close-btn:hover,
.online-users-modal .close-btn:hover {
    color: #333;
}

/* قائمة جهات الاتصال داخل المودال الخاص */
.private-chat-modal-strip .private-chat-list {
    list-style: none;
    padding: 0;
    margin: 0;
    max-height: 300px; /* ارتفاع أقصى للسماح بالتمرير */
    overflow-y: auto; /* تمكين التمرير عند تجاوز المحتوى للارتفاع الأقصى */
    flex-grow: 1; /* ليأخذ المساحة المتاحة بعد الـ header */
    padding-bottom: 5px; /* مسافة داخلية من الأسفل */
}

/* تعديل الـ keyframes لتناسب الموضع الجديد */
@keyframes fadeInFromTopRight {
  from {
    opacity: 0;
    transform: scale(0.9) translateY(-10px); /* يبدأ أصغر قليلاً وأعلى */
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0); /* يظهر بالحجم الطبيعي في مكانه */
  }
}

.private-chat-modal-strip ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.private-chat-modal-strip li {
  display: flex;
  align-items: center;
  padding: 12px 15px; 
  cursor: pointer;
  transition: background-color 0.2s ease;
  direction: rtl; 
  border-bottom: 1px solid #eee; 
}
.private-chat-modal-strip li:last-child {
    border-bottom: none; 
}


.private-chat-modal-strip li:hover {
  background-color: #f0f2f5;
}

.private-chat-modal-strip .user-avatar-small {
  width: 40px; 
  height: 40px; 
  border-radius: 50%; 
  object-fit: cover;
  margin-inline-end: 15px; 
  flex-shrink: 0; 
}

.private-chat-modal-strip .user-name {
  font-weight: bold;
  color: #333;
  font-size: 1.1em; 
  white-space: nowrap; 
  overflow: hidden; 
  text-overflow: ellipsis; 
}

.private-chat-modal-strip .no-users-message {
  padding: 15px;
  text-align: center;
  color: #777;
  font-size: 1.1em; 
}

.private-chat-modal-strip .close-modal-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    font-size: 1.8em; 
    cursor: pointer;
    color: #888;
    z-index: 10; 
}

/* **تعديل الـ media queries لتناسب الحجم الجديد** */
@media (max-width: 768px) {
    .private-chat-modal-strip {
        width: 90%; /* عرض بنسبة 90% */
        right: 10px; /* تقليل المسافة من اليمين قليلاً */
        top: 65px; 
        max-height: calc(100vh - 90px); /* ضبط الارتفاع */
    }
    .private-chat-modal-strip .user-avatar-small {
        width: 35px;
        height: 35px;
        margin-inline-end: 10px;
    }
    .private-chat-modal-strip .user-name {
        font-size: 1em;
    }
}

@media (max-width: 500px) {
    .private-chat-modal-strip {
        width: calc(100% - 20px); /* يملأ العرض مع 10px هامش من كل جانب */
        right: 10px; /* المسافة من اليمين */
        top: 60px;
        max-height: calc(100vh - 80px);
    }
    .private-chat-modal-strip .user-avatar-small {
        width: 30px;
        height: 30px;
        margin-inline-end: 8px;
    }
    .private-chat-modal-strip .user-name {
        font-size: 0.95em;
    }
}

@media (max-width: 360px) {
    .private-chat-modal-strip {
        width: calc(100% - 20px);
        right: 10px;
        top: 55px;
        max-height: calc(100vh - 70px);
        padding: 10px;
    }
    .private-chat-modal-strip li {
        padding: 10px 10px;
    }
    .private-chat-modal-strip .user-avatar-small {
        width: 28px;
        height: 28px;
        margin-inline-end: 5px;
    }
    .private-chat-modal-strip .user-name {
        font-size: 0.9em;
    }
}

/* User Info Modal (when clicking on user avatar/name in chat) */
/* مثال للتنسيقات في style.css بعد التعديل */
.user-info-modal {
    position: fixed; /* يبقى ثابتًا ليعمل فوق كل شيء */
    /* قم بإزالة أي خصائص display: flex, justify-content, align-items إذا كانت موجودة هنا */
    background-color: rgba(0, 0, 0, 0.6); /* خلفية شبه شفافة */
    z-index: 1000; /* مهم لضمان ظهوره فوق المودالات الأخرى */
    opacity: 0;
    visibility: hidden;
    border-radius: 12px; /* للحفاظ على الشكل الجمالي */
}

.user-info-modal.show {
    opacity: 1;
    visibility: visible;
}

/* تأكد من أن هذا موجود أو أضفه لتمكين تموضع زر الإغلاق */
.user-info-modal .modal-content {
    background-color: #eee;
    padding: 25px 20px;
    border-radius: 12px;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
    text-align: center;
    max-width: 320px;
    width: 90%;
    color: #333;
    position: relative; /* **تأكد من وجود هذا السطر** */
    /* يمكن تعديل ال padding ليتناسب مع موقع زر الاغلاق اذا دعت الحاجة */
    padding-top: 20px; /* لترك مساحة لزر الإغلاق في الأعلى */
    padding-bottom: 20px;
}

.user-info-modal .close-button {
    position: absolute; /* **جعله مطلقاً بالنسبة للعنصر الأب** */
    top: 10px; /* **المسافة من الأعلى** */
    left: 10px; /* **المسافة من اليسار** */
    font-size: 1.8em; /* حجم أكبر قليلاً */
    color: #ccc; /* لون فاتح ليتناسب مع الخلفية الداكنة */
    cursor: pointer;
    background: none;
    border: none;
    padding: 0; /* إزالة أي حشوة افتراضية */
    line-height: 1; /* ضبط ارتفاع السطر لمنع مشاكل المحاذاة */
    transition: color 0.2s ease;
    z-index: 1; /* لضمان ظهوره فوق المحتوى */
}

.user-info-modal .close-button:hover {
    color: #fff; /* تغيير اللون عند التحويم */
}

.user-info-modal .user-avatar-large {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    object-fit: cover;
    margin-bottom: 10px;
    border: 3px solid #007bff; /* لون حدود الصورة */
}

.user-info-modal .user-name-display {
    font-weight: bold;
    font-size: 1.1em;
    color: #333;
    margin-bottom: 15px;
}

.user-info-modal .modal-buttons {
    display: flex;
    flex-direction: column; /* ترتيب الأزرار عمودياً */
    gap: 10px; /* المسافة بين الأزرار */
}

.user-info-modal .modal-button {
    padding: 8px 15px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.2s ease;
    width: 100%; /* جعل الأزرار تأخذ عرض المودال كاملاً */
}

.user-info-modal .modal-button.view-profile {
    background-color: #007bff; /* لون زر "عرض الملف الشخصي" */
    color: white;
}

.user-info-modal .modal-button.view-profile:hover {
    background-color: #0056b3;
}

.user-info-modal .modal-button.start-private {
    background-color: #28a745; /* لون زر "بدء خاص" */
    color: white;
}

.user-info-modal .modal-button.start-private:hover {
    background-color: #218838;
}

/* js/style.css */

/* ... (الأنماط الحالية لديك) ... */

/* ---------------------------------------------------------------------- */
/* أنماط مودال الدردشة الفردية الجديدة */
/* ---------------------------------------------------------------------- */

/* التصميم الأساسي للمودال المنبثق في المنتصف */
.private-chat-dialog {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.9); /* يبدأ بحجم أصغر قليلاً */
    width: 90%;
    max-width: 400px;
    height: 80%;
    max-height: 600px;
    background-color: #f9f9f9;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    
    /* إخفاء المودال افتراضياً */
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease-in-out; /* تأثير الانتقال للحركة */
}

/* حالة المودال عند الظهور */
.private-chat-dialog.show {
    opacity: 1;
    visibility: visible;
    transform: translate(-50%, -50%) scale(1);
}

.private-chat-dialog-content {
    display: flex;
    flex-direction: column;
    height: 100%;
    width: 100%;
}

.private-chat-header {
    display: flex;
    align-items: center;
    justify-content: space-between; /* يضع العناصر في الأطراف */
    padding: 10px 15px;
    background-color: #007bff;
    color: white;
    border-bottom: 1px solid #ddd;
    flex-direction: row; /* يجعل الترتيب طبيعي من اليسار لليمين */
}

/* العنصر الذي يجمع الصورة والاسم */
.private-user-info {
    display: flex;
    align-items: center;
    /* لجعل العناصر تترتب بشكل طبيعي من اليسار إلى اليمين */
    flex-direction: row; 
}

.private-chat-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
    margin-left: 10px; /* مسافة عن الاسم */
    margin-right: 0;
    border: 2px solid white;
}

.private-chat-username {
    font-weight: bold;
    font-size: 1.1em;
    flex-grow: 1;
}

.close-private-chat-btn {
    background: none;
    border: none;
    font-size: 1.8em;
    color: white;
    cursor: pointer;
    padding: 0 5px;
    margin-left: 0; /* التعديل هنا: نجعله 0 */
}

.private-chat-messages {
    flex-grow: 1;
    overflow-y: auto;
    padding: 10px;
    background-color: #fff;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.private-message-item {
    max-width: 80%;
    padding: 8px 12px;
    border-radius: 18px;
    line-height: 1.4;
    word-wrap: break-word;
}

.private-message-item.sent {
    align-self: flex-end;
    /* التدرج الأزرق لرسائلك المرسلة */
    background-image: linear-gradient(to right, #4c96d7, #8ecae6);
    color: white;
    border-bottom-right-radius: 4px;
}

.private-message-item.received {
    align-self: flex-start;
    /* التدرج الأرجواني للرسائل المستلمة */
    background-image: linear-gradient(to right, #8e2de2, #4a00e0);
    color: white;
    border-bottom-left-radius: 4px;
}


.private-chat-input-area {
    display: flex;
    padding: 10px;
    border-top: 1px solid #eee;
    background-color: #fff;
}

.private-chat-input {
    flex-grow: 1;
    padding: 10px 15px;
    border: 1px solid #ddd;
    border-radius: 25px;
    margin-left: 10px;
    font-size: 1em;
}

.private-chat-send-btn {
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 1.5em;
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.private-chat-send-btn:hover {
    background-color: #0056b3;
}

/* باقي الأنماط الأخرى */

@keyframes pulse-notification {
  0% {
    transform: scale(1);
    opacity: 1;
  }
  100% {
    transform: scale(1.05);
    opacity: 0.9;
  }
}

.message-name .rank-icon {
    width: 18px;
    height: 18px;
    vertical-align: middle;
    margin-right: 2px;
}

.message-name strong {
    margin: 0;
    padding: 0;
    font-weight: bold;
    font-size: 15px;
    margin-right: 4px;
}

/* js/style.css */

/* أنماط مودال المستخدمين المتصلين */
/* النمط الأساسي للمودال */
.online-users-modal {
    position: fixed;
    background-color: #fff;
    border: 1px solid #ccc;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    border-radius: 8px;
    z-index: 1000;
    display: flex;
    flex-direction: column;
    max-width: 350px; /* عرض أقصى لمودال المتصلين */
    max-height: 80vh; /* ارتفاع أقصى لمودال المتصلين */
    overflow: hidden; /* لمنع المحتوى من تجاوز الحدود */
    top: 60px;
}

.online-users-modal .online-users-list {
    flex-grow: 1;
    overflow-y: auto; /* السماح بالتمرير داخل القائمة */
    padding-top: 5px; /* للحفاظ على مسافة بعد الرأس */
}

/* رأس المودال لجعله ثابتًا */
.online-users-modal .modal-header {
    background-color: #f8f8f8; /* خلفية خفيفة للرأس */
    padding: 15px 20px;
    border-bottom: 1px solid #eee; /* خط فاصل بين الرأس والقائمة */
    display: flex;
    justify-content: space-between; /* لتباعد العنوان وزر الإغلاق */
    align-items: center;
    position: sticky; /* لجعل الرأس ثابتًا عند التمرير */
    top: 0; /* يلتصق بالأعلى داخل المودال */
    z-index: 2; /* للتأكد من أنه فوق قائمة المستخدمين عند التمرير */
    border-top-left-radius: 15px; /* للحفاظ على حدود المودال المستديرة */
    border-top-right-radius: 15px; /* للحفاظ على حدود المودال المستديرة */
}

.online-users-modal .modal-header h3 {
    margin: 0;
    font-size: 1.1em;
    color: #333;
}

.online-users-modal .close-btn {
    background: none;
    border: none;
    font-size: 1.5em;
    cursor: pointer;
    color: #666;
    transition: color 0.3s ease;
}

.online-users-modal .close-btn:hover {
    color: #333;
}

/* قائمة المستخدمين القابلة للتمرير */
.online-users-modal .online-users-list {
    flex-grow: 1; /* للسماح للقائمة بأخذ المساحة المتبقية داخل المودال */
    overflow-y: auto; /* جعل القائمة قابلة للتمرير عمودياً */
    padding: 10px 0; /* هامش داخلي للقائمة */
}

/* عناصر المستخدمين الفردية */
.online-users-modal .user-item {
    display: flex;
    align-items: center;
    padding: 8px 20px;
    border-bottom: 1px solid #f5f5f5; /* خط فاصل بين المستخدمين */
    transition: background-color 0.2s ease;
}

.online-users-modal .user-item:last-child {
    border-bottom: none; /* إزالة الخط الفاصل للمستخدم الأخير */
}

.online-users-modal .user-item:hover {
    background-color: #f9f9f9; /* تغيير الخلفية عند التحويم */
}

/* صورة الأفاتار الصغيرة للمستخدم */
.online-users-modal .user-avatar-small {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    object-fit: cover;
    margin-left: 10px; /* مسافة من اليسار (للنص) */
    border: 1px solid #ddd;
}

/* تفاصيل اسم المستخدم والرتبة */
.online-users-modal .user-name {
    font-weight: bold;
    color: #444;
    flex-grow: 1; /* للسماح للاسم بأخذ المساحة المتاحة */
}

/* نمط الرتبة */
.online-users-modal .user-rank {
    font-size: 0.85em;
    color: #fff; /* لون النص أبيض ليناسب الخلفيات الملونة */
    background-color: #e0e0e0; /* لون افتراضي (سيتم تجاوزها بألوان الرتب) */
    padding: 3px 8px;
    border-radius: 5px;
}

/* رأس الرتبة (مثل "المالك", "المدراء" إلخ) */
/* رأس الرتبة (مثل "المالك", "المدراء" إلخ) */
/* رأس الرتبة (مثل "المالك", "المدراء" إلخ) */
.online-users-modal .rank-header {
    background-color: #e9e9e9; /* لون خلفية لعنوان الرتبة */
    padding: 8px 20px;
    margin-top: 10px;
    border-bottom: 1px solid #ddd;
    font-weight: bold;
    color: #444;
    text-align: center; /* لجعل النص في المنتصف (من التعديل السابق) */
}

.online-users-modal .rank-header h3 {
    margin: 0;
    font-size: 1em;
    color: #555; /* هذا هو اللون الحالي لاسم الرتبة، يمكنك تغييره هنا */
    /* إذا أردت ألوانًا مختلفة لكل رتبة، ستحتاج إلى إضافة قواعد CSS إضافية هنا */
}

/* ألوان خلفية لرؤوس الرتب */

.online-users-modal .rank-header[data-rank="المالك"] {
    background-color: #c0392b; /* أحمر داكن */
    color: #fff; /* نص أبيض ليتناسب مع الخلفية الداكنة */
}

.online-users-modal .rank-header[data-rank="اونر اداري"] {
    background-color: #d35400; /* برتقالي داكن */
    color: #fff;
}

.online-users-modal .rank-header[data-rank="اونر"] {
    background-color: #f1c40f; /* أصفر (قد تحتاج نصاً داكناً هنا) */
    color: #333;
}

.online-users-modal .rank-header[data-rank="سوبر اداري"] {
    background-color: #2980b9; /* أزرق داكن */
    color: #fff;
}

.online-users-modal .rank-header[data-rank="سوبر ادمن"] {
    background-color: #27ae60; /* أخضر داكن */
    color: #fff;
}

.online-users-modal .rank-header[data-rank="ادمن"] {
    background-color: #8e44ad; /* بنفسجي داكن */
    color: #fff;
}

.online-users-modal .rank-header[data-rank="عضو"] {
    background-color: #34495e; /* رمادي أزرق داكن */
    color: #fff;
}

.online-users-modal .rank-header[data-rank="زائر"] {
    background-color: #7f8c8d; /* رمادي متوسط */
    color: #fff;
}

/* يمكنك إضافة أي رتب أخرى لديك بنفس النمط */
/*
.online-users-modal .rank-header[data-rank="اسم_الرتبة_هنا"] {
    background-color: #كود_اللون_هنا;
    color: #لون_النص_هنا;
}
*/
/* تنسيقات لمربع رسالة الترحيب الجديد في مودال المتصلين */
.online-users-modal .welcome-message-box {
    text-align: center; /* توسيط النص */
    padding: 10px 15px; /* مسافة داخلية */
    margin: 10px auto; /* مسافة خارجية من الأعلى والأسفل وتوسيط أفقي */
    background-color: #dff0d8; /* لون خلفية أخضر فاتح (يمكنك تغييره) */
    color: #3c763d; /* لون نص أخضر داكن */
    border: 1px solid #d6e9c6; /* حدود رقيقة بنفس لون الخلفية */
    border-radius: 8px; /* حواف دائرية */
    font-size: 0.95em; /* حجم خط أصغر قليلاً */
    max-width: calc(100% - 30px); /* عرض أقصى مع بعض الهوامش */
    box-shadow: 0 2px 4px rgba(0,0,0,0.05); /* ظل خفيف */
}

/* تنسيقات قائمة المستخدمين المتصلين (للتأكد من عدم وجود هوامش علوية تدفع للأسفل) */
.online-users-modal .online-users-list {
    margin-top: 0; /* **مهم: إزالة أي هامش علوي يدفع القائمة لأسفل** */
    padding-top: 0; /* **مهم: إزالة أي مسافة داخلية علوية تدفع المحتوى لأسفل** */
    flex-grow: 1; /* السماح للقائمة بملء المساحة المتبقية */
    overflow-y: auto; /* السماح بالتمرير إذا كان المحتوى أكبر من المساحة */
    display: flex; /* لضمان أن العناصر الداخلية لا تسبب مسافات غير مرغوبة */
    flex-direction: column;
}

/* تنسيقات رسالة التحميل داخل قائمة المستخدمين (إذا كانت هذه هي المساحة التي تقصدها) */
.online-users-modal .online-users-list > div {
    /* هذا يستهدف رسالة "جاري تحميل المستخدمين..." */
    margin-top: 0; /* إزالة أي هامش علوي */
    padding-top: 10px; /* **يمكنك تعديل هذه المسافة إذا أردت مسافة من أعلى القائمة** */
}

/* ألوان الرتب (تأكد من مطابقتها لما لديك في constants.js) */

/* تنسيقات جديدة لأزرار رأس مودال المتصلين */
/* تنسيقات أزرار رأس مودال المتصلين لتكون مثل الصورة */
/* هذا هو الكود من ردي السابق الذي يجب أن يكون في style.css لديك */
.online-users-modal .new-header-buttons {
    display: flex;
    justify-content: space-between; /* هذه الخاصية هي التي تضع المحتوى في اليمين وزر الإغلاق في أقصى اليسار (لصفحات RTL) */
    align-items: center;
    padding: 5px 5px; /* تم التعديل: تقليل المسافة الداخلية للرأس بشكل أكبر لتوفير مساحة */
    background-color: #6a0dad; /* **تم التعديل: لون الخلفية بنفسجي داكن** */
    border-bottom: 1px solid #5a0c9b; /* **تم التعديل: لون حدود أغمق قليلاً ليتناسق مع البنفسجي** */
    min-height: 38px; /* تم التعديل: تقليل الارتفاع الأدنى للرأس */
}

.online-users-modal .header-buttons-container {
    display: flex;
    gap: 4px; /* تم التعديل: تقليل المسافة بين الأزرار إلى الحد الأدنى */
    flex-grow: 1;
    justify-content: flex-start; /* محاذاة الأزرار إلى اليمين داخل حاويتها */
    align-items: center;
}

.online-users-modal .header-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;

    background-color: rgba(255, 255, 255, 0.1); /* **تم التعديل: خلفية شفافة خفيفة للأزرار** */
    color: #fff; /* **تم التعديل: نص أبيض ليناسب الخلفية البنفسجية** */
    border: 1px solid rgba(255, 255, 255, 0.3); /* **تم التعديل: حدود فاتحة شفافة** */
    padding: 1px 6px; /* تم التعديل: تقليل المسافة الداخلية للأزرار إلى أقصى حد */
    border-radius: 12px;
    cursor: pointer;
    font-size: 0.65em;
    font-weight: 500;
    transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
    box-shadow: none; /* **تم التعديل: إزالة الظل أو جعله أفتح ليتناسق مع اللون البنفسجي** */
    min-width: 40px;
    height: 32px;
}

.online-users-modal .header-btn .icon {
    font-size: 1em;
    margin-bottom: 0px;
    line-height: 1;
}

.online-users-modal .header-btn:hover {
    background-color: rgba(255, 255, 255, 0.2); /* **تم التعديل: خلفية شفافة أغمق عند التحويم** */
    border-color: rgba(255, 255, 255, 0.5); /* **تم التعديل: حدود أفتح عند التحويم** */
    box-shadow: none; /* أو ظل خفيف جداً بلون بنفسجي أغمق */
}

.online-users-modal .new-header-buttons .close-btn {
    background: none;
    border: none;
    color: #fff; /* **تم التعديل: لون أبيض لرمز الإغلاق** */
    font-size: 1.3em;
    cursor: pointer;
    line-height: 1;
    padding: 0 2px;
    transition: color 0.2s ease;
    margin: 0;
    flex-shrink: 0;
}

.online-users-modal .new-header-buttons .close-btn:hover {
    color: #eee; /* **تم التعديل: لون أبيض أفتح عند التحويم** */
}

/* في ملف style.css */

.online-users-modal {
    /* ... (احتفظ بالأنماط الموجودة لتحديد الموضع، الخلفية، الحجم، إلخ) ... */
    display: flex; /* اجعله flex container */
    flex-direction: column; /* لترتيب العناصر عمودياً: Header ثم Content Area */
    /* تأكد من أن الارتفاع والقاعدة ثابتين ليظل المودال مرئياً */
    /* height: 80%; */ /* مثال: يمكنك تعيين ارتفاع ثابت أو أقصى ارتفاع */
    /* bottom: 10px; */ /* مثال: موضع المودال من الأسفل */
}

.online-users-modal .modal-header {
    /* ... (احتفظ بأنماط الـ header) ... */
    flex-shrink: 0; /* تأكد من أن الـ header لا يتقلص ويحتفظ بارتفاعه */
}

.online-users-modal .modal-content-area {
    flex-grow: 1; /* اجعل منطقة المحتوى تأخذ المساحة المتبقية */
    overflow-y: auto; /* للسماح بالتمرير داخل المحتوى إذا كان طويلاً */
    /* يمكنك إضافة padding إذا لزم الأمر */
}

.welcome-message-box {
    padding: 15px;
    text-align: center;
    color: #eee;
    background-color: #3a3a3a;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    margin-bottom: 5px;
    font-size: 0.95em;
}

.search-input-container {
    display: flex;
    align-items: center;
    padding: 10px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    
    position: sticky; /* لجعل حقل البحث ثابتاً في الأعلى عند التمرير */
    top: 0; /* مهم لجعل sticky يعمل */
    z-index: 10; /* لضمان ظهوره فوق العناصر الأخرى عند التمرير */
}

.search-input-container input {
    flex-grow: 1;
    padding: 8px 10px;
    border: 1px solid #555;
    border-radius: 5px;
    background-color: #333;
    color: #eee;
    font-size: 0.9em;
    margin-right: 5px;
}

.search-input-container input::placeholder {
    color: #aaa;
}

#clear-search-btn {
    background: none;
    border: none;
    color: #aaa;
    font-size: 1.2em;
    cursor: pointer;
    padding: 0 5px;
    display: none;
}

.search-results-list {
    flex-grow: 1;
    overflow-y: auto; /* إذا أردت تمرير النتائج بشكل منفصل عن حقل البحث */
    padding: 10px;
    /* استخدم نفس أنماط .online-users-list إذا كانت مناسبة لتنسيق عناصر المستخدمين */
}

.rank-header {
    background-color: #444;
    color: #fff;
    padding: 8px 10px;
    margin-top: 10px;
    margin-bottom: 5px;
    border-radius: 5px;
    font-size: 0.9em;
    font-weight: bold;
    text-align: center;
    position: sticky; /* لجعل رؤوس الرتب ثابتة عند التمرير */
    top: 0; /* مهم لجعل sticky يعمل */
    z-index: 5; /* أقل من حقل البحث */
}

.user-rank-image {
    width: 16px; /* أو الحجم الذي تراه مناسباً */
    height: 16px; /* أو الحجم الذي تراه مناسباً */
    margin-left: 5px; /* مسافة بين اسم المستخدم والصورة */
    vertical-align: middle; /* لمحاذاة الصورة مع النص */
}

/* css/style.css */

/* ... (بقية أكواد CSS لديك) ... */

/* قواعد إخفاء الأزرار افتراضياً لمنع الوميض عند التحميل */

/* إخفاء زر البلاغ افتراضياً مع الحفاظ على مساحته */
.top-bar .btn.report {
    visibility: hidden;
    pointer-events: none; /* لضمان عدم قابليته للنقر وهو مخفي */
}

/* إخفاء زر الخاص افتراضياً (سيظهر إذا لم يكن المستخدم زائراً) */
.top-bar .btn.private {
    display: none;
}

/* إخفاء زر التسجيل افتراضياً (يجب أن يكون مخفياً في HTML أيضاً) */
.top-bar .btn.register {
    display: none;
}

/* css/style.css */

/* ... (بقية أكواد CSS لديك) ... */

/* إخفاء زر "بدء خاص" افتراضياً داخل مودال معلومات المستخدم لمنع الوميض */
.user-info-modal .modal-button.start-private {
    display: none; /* سيقوم هذا بإخفاء الزر تماماً عند تحميل المودال */
}

.profile-dropdown-menu {
  display: flex;
  flex-direction: column;
  position: absolute; /* **تم التعديل: أصبح absolute ليظهر كمنبثق** */
  /* top و right لن يتم تحديدهما هنا، بل في JavaScript */
  width: 280px; /* عرض ثابت للمودال */
  height: auto; /* الارتفاع ديناميكي حسب المحتوى */
  max-height: calc(100vh - 40px); /* أقصى ارتفاع للمودال لكي لا يتجاوز الشاشة (مع مسافة من الأعلى والأسفل) */
  overflow-y: auto; /* للسماح بالتمرير إذا زاد المحتوى عن max-height */
  background-color: #fefefe;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); /* ظل عادي للمودال المنبثق */
  z-index: 1001;
  border-radius: 12px; /* **تم التعديل: حدود منحنية موحدة للمودال** */

  /* لجعله مخفياً افتراضياً مع تأثير انبثاق */
  opacity: 0;
  visibility: hidden;
  transform: scale(0.95) translateY(-10px); /* **تم التعديل: تأثير تصغير وحركة بسيطة** */
  transform-origin: top right; /* **تم التعديل: نقطة الأصل للتأثير من أعلى اليمين** */
  transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
}

/* عندما يكون المودال ظاهراً */
.profile-dropdown-menu.show {
  opacity: 1;
  visibility: visible;
  transform: scale(1) translateY(0); /* **تم التعديل: يظهر بالحجم الطبيعي بدون حركة** */
}

/* محتوى القائمة المنبثقة (ليصبح محتوى الشريط الجانبي) */
.profile-dropdown-content {
  padding: 0; /* **تم التعديل: إزالة البادينج الأساسي، سيتم وضع البادينج في الأقسام الداخلية** */
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  overflow-y: auto; /* للسماح بالتمرير إذا كان المحتوى طويلاً */
  padding-bottom: 20px; /* **اختياري: مسافة سفلية للمحتوى** */
}

/* قسم الرأس (الصورة، الرتبة، الاسم) - تم تصغيره */
.profile-header {
    display: flex;
    align-items: center;
    padding: 12px 15px;
    background: linear-gradient(135deg, #007bff, #0056b3); /* تدرج أزرق جذاب */
    color: white;
    margin-bottom: 15px;
    border-bottom: 1px solid #eee;
    gap: 8px; /* **تمت الإضافة: مسافة 8 بكسل بين عناصر Flexbox (الصورة وكتلة المعلومات)** */
}

/* تنسيقات صورة البروفايل داخل الشريط - تم تصغيرها */
#modal-profile-image {
    width: 48px;
    height: 48px;
    border-radius: 8px;
    object-fit: cover;
    display: block;
    /* margin-right: 5px; **تمت إزالة هذا السطر أو يمكنك تعيينه إلى 0** */
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

/* حاوية لمعلومات البروفايل (الرتبة والاسم) -/* حاوية لمعلومات البروفايل (الرتبة والاسم) */
.profile-info {
    display: flex;
    flex-direction: column;
    align-items: flex-end; /* لمحاذاة الرتبة والاسم لليمين داخل كتلتهم */
    /* flex-grow: 1; **تمت إزالة هذا السطر** */
}

/* تنسيقات عنصر الرتبة - تم تصغيرها */
.profile-rank-display {
display: flex;
align-items: center;
justify-content: flex-end;
font-size: 0.8em;
    background-color: rgba(255, 255, 255, 0.2); /* خلفية بيضاء شفافة */
    color: white; /* لون النص يصبح أبيض */
    border-radius: 5px; /* حواف دائرية للرتبة */
    padding: 2px 8px; /* مسافة داخلية مناسبة */
margin-bottom: 3px;
flex-direction: row-reverse;
}
.profile-rank-display .rank-icon {
width: 16px;
height: 16px;
margin-left: 4px;  margin-left 
margin-right: 0;
vertical-align: middle;
}

/* تنسيقات اسم المستخدم - تم تصغيرها */
#modal-username-display {
    font-size: 1.1em;
    color: white;
    margin: 0; /* تأكد من عدم وجود هوامش إضافية */
    font-weight: bold;
    text-align: right; /* **للتأكيد على المحاذاة لليمين** */
}

/* قسم الأزرار */
.profile-buttons-section {
    display: flex;
    flex-direction: column;
    padding: 0 20px; /* بادينج جانبي للأزرار فقط */
}
/* تنسيقات الأزرار داخل القائمة المنبثقة */
.profile-dropdown-content .modal-button {
  background: linear-gradient(135deg, #f8f9fa, #e9ecef); /* تدرج لوني خفيف */
  color: #333;
  padding: 12px 15px;
  border: 1px solid #dee2e6;
  border-radius: 12px;
  cursor: pointer;
  font-size: 16px;
  width: 100%;
  margin-bottom: 12px;
  transition: all 0.3s ease; /* تغيير جميع الانتقالات لتكون سلسة */
  box-sizing: border-box;
  display: flex;
  align-items: center;
  justify-content: space-between;
  text-align: right;
  box-shadow: 0 4px 6px rgba(0,0,0,0.08); /* ظل أكثر وضوحاً */
}

/* عند التحويم */
.profile-dropdown-content .modal-button:hover {
  background: linear-gradient(135deg, #e9ecef, #adb5bd); /* تدرج أغمق عند التحويم */
  color: #000;
  border-color: #adb5bd;
  box-shadow: 0 6px 12px rgba(0,0,0,0.15); /* ظل أكبر عند التحويم */
  transform: translateY(-2px); /* تأثير رفع خفيف للزر */
}

/* تنسيقات الأيقونات داخل الأزرار */
.profile-dropdown-content .modal-button .icon {
    font-size: 1.4em;
    margin-left: 10px;
    color: #007bff; /* لون الأيقونة أزرق */
}

/* إذا كنت تريد أي نص إضافي داخل المودال */
.profile-dropdown-content p {
    margin: 5px 0;
    color: #555;
    font-size: 0.9em;
}

/* لتحديد موضع زر البروفايل وجعله مرجعاً للموضع المطلق (هذا يبقى كما هو) */
.top-bar .profile {
  position: relative;
  cursor: pointer;
}

/* أنماط مودال معلومات المستوى */
.level-info-modal {
    position: fixed;
    /* التعديل 1: ليكون أعلى قليلاً */
    top: 10%;
    /* التعديل 2: للحفاظ على مسافة من الجوانب */
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    max-width: 400px;
    background-color: #fff;
    border-radius: 15px;
    box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
    z-index: 1500;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    padding: 20px;
    direction: rtl;
}

.level-info-modal.show {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) scale(1);
}

.level-info-modal .modal-content h3 {
    text-align: center;
    color: #333;
    margin-bottom: 20px;
    font-size: 1.5em;
    border-bottom: 2px solid #007bff;
    padding-bottom: 10px;
}

.level-info-modal .close-btn {
    position: absolute;
    top: 15px;
    left: 15px;
    background: none;
    border: none;
    font-size: 2em;
    color: #999;
    cursor: pointer;
}

.level-info-card {
    background-color: #f8f9fa;
    border-radius: 10px;
    padding: 15px;
    border: 1px solid #dee2e6;
}

.level-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    border-bottom: 1px solid #e9ecef;
    padding-bottom: 5px;
}

.level-item:last-of-type { /* تم التعديل لاستهداف آخر عنصر من نفس النوع */
    border-bottom: none;
    margin-bottom: 0;
}

.level-item .label {
    font-weight: bold;
    color: #495057;
}

.level-item .value {
    color: #007bff;
    font-weight: 600;
}

.progress-bar-container {
    width: 100%;
    height: 10px;
    background-color: #e9ecef;
    border-radius: 5px;
    overflow: hidden;
    margin-top: 15px;
}

.progress-bar {
    height: 100%;
    background: linear-gradient(90deg, #007bff, #0056b3);
    transition: width 0.5s ease-in-out;
}

/* زر الإغلاق الجديد */
.level-info-modal .close-button-footer {
    width: 60px;
    height: 40px;
    background-color: #6a0dad;
    color: white;
    font-size: 0.9em;
    display: flex;
    justify-content: center;
    align-items: center;
    /* إزالة position: absolute; *//* ... */
    margin-top: 15px;
    margin-left: auto; /* هذا هو التعديل. سيتم دفع الزر إلى اليسار. */
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

.level-info-modal .close-button-footer:hover {
    background-color: #5d0c9b;
}

.level-info-modal .modal-content {
    display: flex;
    flex-direction: column;
    align-items: flex-end; /* لمحاذاة المحتوى والأزرار إلى اليمين */
    width: 100%; /* هذا هو التعديل. سيجعل المحتوى يأخذ العرض الكامل. */
}


/* تنسيق بطاقة المعلومات لتأخذ العرض الكامل */
.level-info-modal .level-info-card {
    width: 90%;
    /* ... (بقية الأنماط) ... */
}

/* الخلفية المعتمة للمودال */
.level-info-backdrop {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5); /* لون أسود مع شفافية */
    backdrop-filter: blur(5px); /* تأثير ضبابي على المحتوى الخلفي */
    z-index: 1499; /* يجب أن يكون أقل من z-index للمودال */
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease;
}

.level-info-backdrop.show {
    opacity: 1;
    visibility: visible;
}

/* تنسيق شارة المستوى على صورة البروفايل */
/* تصميم شريط المستوى أسفل الصورة */
.message-avatar {
    position: relative;
    /* لجعل الشريط يظهر بشكل صحيح */
    overflow: visible; 
}

.level-badge {
    position: absolute;
    bottom: -3px; /* يوضع أسفل الصورة */
    left: 50%;
    transform: translateX(-50%); /* لتوسيط الشريط أفقياً */
    background-color: #007bff; /* تصحيح لون الخلفية */
    color: white;
    font-size: 0.7em;
    font-weight: bold;
    padding: 2.5px 20px; /* حجم الشريط */
    border-radius: 4px; /* تصحيح حواف دائرية قليلاً */
    border: 1px solid #fff; /* حدود بيضاء */
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
    z-index: 500;
}

/* هذا يضمن أن العنصر الأب يمكنه تحديد موضع العناصر الداخلية */
.top-bar .btn.private {
  position: relative; 
}

/* هذا الكود هو الذي ينشئ الدائرة الحمراء */
.top-bar .btn.private.has-new-messages::after {
  content: '';
  position: absolute;
  top: 2px; /* يمكنك تعديل هذه القيمة لتغيير الموضع الرأسي */
  left: 2px; /* يمكنك تعديل هذه القيمة لتغيير الموضع الأفقي */
  width: 10px;
  height: 10px;
  background-color: red;
  border-radius: 50%;
  border: 1px solid white; /* لجعلها أكثر وضوحاً */
  z-index: 10;
}

/* تصميم زر الرسائل الخاصة داخل المودال */
.private-chat-list li {
    position: relative; /* مهم جدا لتحديد موقع الدائرة */
    display: flex;
    align-items: center;
    padding: 10px;
    cursor: pointer;
    border-bottom: 1px solid #eee;
}

/* تصميم دائرة الرسائل غير المقروءة */
.private-chat-list .unread-count {
    position: absolute;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    background-color: red;
    color: white;
    font-size: 10px;
    font-weight: bold;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2px;
}

/* style.css */

/* ... (بقية التنسيقات الموجودة) */

/* style.css */

/* ... (بقية التنسيقات الموجودة) */

.join-message-item {
    /* لون الخلفية، يمكنك اختيار أي لون تريده */
    background-color: #89c; /* لون أصفر فاتح مع شفافية */
    border-radius: 8px; /* حواف دائرية */
    padding: 8px; /* تباعد داخلي */
    margin-bottom: 10px; /* تباعد عن الرسائل الأخرى */
    border-left: 3px solid #ffc107; /* شريط جانبي بلون أصفر غامق */
}

/* لتنسيق النص داخل رسالة الانضمام */
.join-message-item .message-text {
    font-style: italic; /* خط مائل */
    color: #343a40; /* لون نص داكن */
    font-weight: bold; /* خط عريض */
}

/* style.css */

/* ... (بقية التنسيقات الموجودة) */

.join-message-item .join-word {
    background-color: #89cff0; /* لون خلفية أزرق فاتح */
    color: #000; /* لون نص أسود */
    padding: 2px 6px; /* تباعد داخلي خفيف */
    border-radius: 4px; /* حواف دائرية */
    font-weight: bold; /* خط عريض */
    white-space: nowrap; /* يمنع الكلمة من الانقسام */
}
